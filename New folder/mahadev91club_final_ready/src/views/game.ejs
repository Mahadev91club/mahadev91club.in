<h2 class="mb-3">Color Prediction</h2>
<p class="text-secondary">Login first to play. Coins-only entertainment.</p>

<div class="row g-3">
  <div class="col-md-6">
    <div class="card bg-black border-secondary">
      <div class="card-body">
        <label class="form-label">Bet Coins</label>
        <input id="bet" type="number" class="form-control mb-3" value="10" min="1">
        <div class="d-flex gap-2 mb-3">
          <button class="btn btn-outline-light" onclick="setChoice('red')">RED</button>
          <button class="btn btn-outline-light" onclick="setChoice('green')">GREEN</button>
          <button class="btn btn-outline-light" onclick="setChoice('violet')">VIOLET</button>
        </div>
        <button class="btn btn-primary" onclick="play()">Play</button>
        <div id="status" class="mt-3 small text-secondary"></div>
      </div>
    </div>
  </div>
  <div class="col-md-6">
    <div class="card bg-black border-secondary">
      <div class="card-body">
        <h5>Wallet</h5>
        <div id="wallet" class="text-secondary">--</div>
        <button class="btn btn-success btn-sm mt-2" onclick="addBonus()">+100 Bonus Coins</button>
      </div>
    </div>
  </div>
</div>

<script>
let choice = 'red';
function setChoice(c){ choice = c; [...document.querySelectorAll('.btn-outline-light')].forEach(b=>b.classList.remove('active')); }
async function play(){
  const bet = Number(document.getElementById('bet').value || 1);
  const res = await fetch('/game/play', { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({ choice, betCoins: bet }) });
  const data = await res.json();
  document.getElementById('status').textContent = res.ok ? `Result: ${data.result.toUpperCase()} | Won: ${data.coinsWon} | Wallet: ${data.currentCoins}` : (data.error || 'Error');
  loadWallet();
}
async function loadWallet(){
  const res = await fetch('/wallet/me'); if(!res.ok){ document.getElementById('wallet').textContent = 'Login required'; return; }
  const d = await res.json(); document.getElementById('wallet').textContent = `Coins: ${d.coins} | VIP: ${d.vipTier || 'none'}`;
}
async function addBonus(){
  const res = await fetch('/wallet/add', { method:'POST' }); if(res.ok){ loadWallet(); }
}
loadWallet();
</script>
